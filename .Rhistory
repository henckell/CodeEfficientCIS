p_50_1a_l1_2, p_500_1a_l1_2, p_infty_1a_l1_2, ncol=1)
comparison_l1_1 <- comparison_l1[,1:10]
names_comparisons_l1_1 <- names_comparisons_l1[1:10]
p_50_1a_l1 <- plot_MSE_comparison(RMSE_1[n==50,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}, n=50$"))
p_500_1a_l1 <- plot_MSE_comparison(RMSE_1[n==500,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}, n=500$"))
p_infty_1a_l1 <- plot_MSE_comparison(aSE_1[n==50,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}"),ytitle="Asy. SD ratio")
comparison_l1_2 <- comparison_l1[,11:20]
names_comparisons_l1_2 <- names_comparisons_l1[11:20]
p_50_1a_l1_2 <- plot_MSE_comparison(RMSE_1[n==50,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}, n=50$"))
p_500_1a_l1_2 <- plot_MSE_comparison(RMSE_1[n==500,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}, n=500$"))
p_infty_1a_l1_2 <- plot_MSE_comparison(aSE_1[n==50,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}"),ytitle="Asy. SD ratio")
grid.arrange(p_50_1a_l1, p_500_1a_l1, p_infty_1a_l1,
p_50_1a_l1_2, p_500_1a_l1_2, p_infty_1a_l1_2, ncol=1)
comparison_l1 <- matrix(c(21,1,
21,2,
21,3,
21,4,
21,5,
21,6,
21,7,
21,8,
21,9,
21,10,
21,11,
21,12,
21,13,
21,14,
21,15,
21,16,
21,17,
21,18,
21,19,
21,20
# 21,22
),nrow=2)
names_comparisons_l1 <- c("(A,{B,D})",
"(A,{C,D})",
"(A,{B,C,D})",
"(B,C)",
"(B,{A,C})",
"(B,{C,D})",
"(B,{A,C,D})",
"(D,B)",
"(D,C)",
"(D,{B,C})",
"(D,{A,B})",
"(D,{A,C})",
"(D,{A,B,C})",
"({B,D},C)",
"{{B,D},{A,C}}",
"({A,B},C)",
"({A,B},{C,D})",
"({A,D},B)",
"({A,D},C)",
"({A,D},{B,C})"
# "OLS"
)
comparison_l1_1 <- comparison_l1[,1:10]
names_comparisons_l1_1 <- names_comparisons_l1[1:10]
p_50_1a_l1 <- plot_MSE_comparison(RMSE_1[n==50,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}, n=50$"))
p_500_1a_l1 <- plot_MSE_comparison(RMSE_1[n==500,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}, n=500$"))
p_infty_1a_l1 <- plot_MSE_comparison(aSE_1[n==50,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}"),ytitle="Asy. SD ratio")
comparison_l1_2 <- comparison_l1[,11:20]
names_comparisons_l1_2 <- names_comparisons_l1[11:20]
p_50_1a_l1_2 <- plot_MSE_comparison(RMSE_1[n==50,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}, n=50$"))
p_500_1a_l1_2 <- plot_MSE_comparison(RMSE_1[n==500,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}, n=500$"))
p_infty_1a_l1_2 <- plot_MSE_comparison(aSE_1[n==50,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}"),ytitle="Asy. SD ratio")
grid.arrange(p_50_1a_l1, p_500_1a_l1, p_infty_1a_l1,
p_50_1a_l1_2, p_500_1a_l1_2, p_infty_1a_l1_2, ncol=1)
p_50_1a_l1 <- plot_MSE_comparison(RMSE_1[n==50,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}, n=50$"),bw=.1)
p_500_1a_l1 <- plot_MSE_comparison(RMSE_1[n==500,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}, n=500$"),bw=.1)
p_infty_1a_l1 <- plot_MSE_comparison(aSE_1[n==50,],comparison_l1_1,names_comparisons_l1_1,title=TeX("$G_{1}"),ytitle="Asy. SD ratio",bw=.1)
p_50_1a_l1_2 <- plot_MSE_comparison(RMSE_1[n==50,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}, n=50$"),bw=.1)
p_500_1a_l1_2 <- plot_MSE_comparison(RMSE_1[n==500,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}, n=500$"),bw=.1)
p_infty_1a_l1_2 <- plot_MSE_comparison(aSE_1[n==50,],comparison_l1_2,names_comparisons_l1_2,title=TeX("$G_{1}"),ytitle="Asy. SD ratio",bw=.1)
grid.arrange(p_50_1a_l1, p_500_1a_l1, p_infty_1a_l1,
p_50_1a_l1_2, p_500_1a_l1_2, p_infty_1a_l1_2, ncol=1)
pdf("example_l1.pdf",width=9, height=15)
pdf("example_l1.pdf",width=9, height=15)
grid.arrange(p_50_1a_l1, p_500_1a_l1, p_infty_1a_l1,
p_50_1a_l1_2, p_500_1a_l1_2, p_infty_1a_l1_2, ncol=1)
dev.off()
RMSE_joint_1
library(xtable)
library(MASS)
library(stats)
library(ggplot2)
library(gridExtra)
library(latex2exp)
#### take the square root of the MSE
source("meanFunctions.R")
source("functions.R")
reps <- 100
k <- 100
ss <- c(50,500)
n <- c()
for(i in 1:length(ss)) n <- c(n,rep(ss[i],k))
#a,b,c,l,d,x,y
B <- matrix(c(0,0,0,0,0,0,0,
0,0,0,0,0,0,0,
0,0,0,0,0,0,0,
0,0,0,0,0,0,0,
1,0,0,0,0,0,0,
0,1,0,1,1,0,0,
0,0,1,1,0,1,0),nrow=7)
x <- 6
y <- 7
Z <- list()
C <- list()
#a,b,c,l,d,x,y
#1,2,3,4,5,6,7
Z[[1]] <- c(1)
Z[[2]] <- c(1)
Z[[3]] <- c(1)
Z[[4]] <- c(1)
Z[[5]] <- c(2)
Z[[6]] <- c(2)
Z[[7]] <- c(2)
Z[[8]] <- c(2)
Z[[9]] <- c(2)
Z[[10]] <- c(2)
Z[[11]] <- c(2)
Z[[12]] <- c(2)
Z[[13]] <- c(5) # "({D},em)"
Z[[14]] <- c(5) # "({D},\{A\})"
Z[[15]] <- c(5) # "({D},\{B\})"
Z[[16]] <- c(5) # "({D},\{C\})"
Z[[17]] <- c(5) # "({D},\{A,B\})"
Z[[18]] <- c(5) # "({D},\{A,C\})"
Z[[19]] <- c(5) # "({D},\{B,C\})"
Z[[20]] <- c(5) # "({D},\{A,B,C\})"
Z[[21]] <- c(1,2)
Z[[22]] <- c(1,2)
Z[[23]] <- c(1,2)
Z[[24]] <- c(1,2)
Z[[25]] <- c(1,5)
Z[[26]] <- c(1,5)
Z[[27]] <- c(1,5)
Z[[28]] <- c(1,5)
Z[[29]] <- c(2,5) # optimal instrument
Z[[30]] <- c(2,5)
Z[[31]] <- c(2,5) # optimal CIS
Z[[32]] <- c(2,5)
Z[[33]] <- c(1,2,5) # optimal instrument
Z[[34]] <- c(1,2,5) # optimal CIS 2
Z[[35]] <- c() # plain OLS
Z[[36]] <- c(1) # filler to prevent bugs
C[[1]] <- c() # single instrument A
C[[2]] <- c(2)
C[[3]] <- c(3)
C[[4]] <- c(2,3)
C[[5]] <- c() # single instrument B
C[[6]] <- c(1)
C[[7]] <- c(3)
C[[8]] <- c(5)
C[[9]] <- c(1,3)
C[[10]] <- c(1,5)
C[[11]] <- c(3,5)
C[[12]] <- c(1,3,5)
C[[13]] <- c() # single instrument D
C[[14]] <- c(1)
C[[15]] <- c(2)
C[[16]] <- c(3)
C[[17]] <- c(1,2)
C[[18]] <- c(1,3)
C[[19]] <- c(2,3)
C[[20]] <- c(1,2,3)
C[[21]] <- c() # instrument \{A,B\}
C[[22]] <- c(3)
C[[23]] <- c(5)
C[[24]] <- c(3,5)
C[[25]] <- c() # instrument \{A,D\}
C[[26]] <- c(2)
C[[27]] <- c(3)
C[[28]] <- c(2,3)
C[[29]] <- c() # optimal instrument \{B,D\}
C[[30]] <- c(1)
C[[31]] <- c(3) # optimal CIS
C[[32]] <- c(1,3)
C[[33]] <- c() # instrument \{A,B,D\}
C[[34]] <- c(3) # optimal CIS 2
C[[35]] <- c() # plain OLS
C[[36]] <- c(2) # filler to prevent bugs
set.seed(60)
Parameters_1 <- generate_parameters(B,k) # generate Parameters
errors <- sample(c("Gaussian","uniform"),k,replace=TRUE)
# c("Gaussian","uniform")
k2 <- length(Z)
MSE_2 <- matrix(numeric(length(ss)*k*k2),nrow=length(ss)*k)
Avar_2 <- matrix(numeric(length(ss)*k*k2),nrow=length(ss)*k)
Var_2 <- matrix(numeric(length(ss)*k*k2),nrow=length(ss)*k)
Bias_2 <- matrix(numeric(length(ss)*k*k2),nrow=length(ss)*k)
for(j in 1:length(ss)){
for(i in 1:k){
Results_2 <- testGraph(n[(j-1)*k+i],reps,Parameters_1[[1]][,i],Parameters_1[[2]][,i],x,y,Z,C,B
,error=errors[i],complex = FALSE)
MSE_2[(j-1)*k+i,] <- Results_2[1,]
Avar_2[(j-1)*k+i,] <- Results_2[2,]
Var_2[(j-1)*k+i,] <- Results_2[3,]
Bias_2[(j-1)*k+i,] <- Results_2[4,]
}
}
aSE_2 <- sqrt(Avar_2)
RMSE_2 <- sqrt(MSE_2)
comparison_l2 <- rbind(c(rep(31,34)),c(1:30,32:35))
names_comparisons_l2 <- c("(A,\u2205)",
"(A,B)",
"(A,C)",
"(A,{B,C})",
"(B,\u2205)",
"(B,A)",
"(B,C)",
"(B,D)",
"(B,{A,C})",
"(B,{A,D})",
"(B,{C,D})",
"(B,{A,B,D})",
"(D,\u2205)",
"(D,A)",
"(D,B)",
"(D,C)",
"(D,{A,B})",
"(D,{A,C})",
"(D,{B,C})",
"(D,{A,B,C})",
"({A,B},\u2205)",
"({A,B},C)",
"({A,B},D)",
"({A,B},{C,D})",
"({A,D},\u2205)",
"({A,D},B)",
"({A,D},C)",
"({A,D},{B,C})",
"({B,D},\u2205)",
"({B,D},A)",
"({B,D},{A,C})",
"({A,B,D},\u2205)",
"({A,B,D},C)",
"OLS")
comparison_l2_1 <- comparison_l2[,1:8]
names_comparisons_l2_1 <- names_comparisons_l2[1:8]
p_50_2a_l2_1 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_1 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_1 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
pdf("example_l2_1.pdf",width=9, height=7.5)
grid.arrange(p_50_2a_l2_1, p_500_2a_l2_1, p_infty_2a_l2_1, ncol=1)
dev.off()
comparison_l2_2 <- comparison_l2[,9:16]
names_comparisons_l2_2 <- names_comparisons_l2[9:16]
p_50_2a_l2_2 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_2 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_2 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
pdf("example_l2_2.pdf",width=9, height=7.5)
grid.arrange(p_50_2a_l2_2, p_500_2a_l2_2, p_infty_2a_l2_2, ncol=1)
dev.off()
comparison_l2_3 <- comparison_l2[,17:25]
names_comparisons_l2_3 <- names_comparisons_l2[17:25]
p_50_2a_l2_3 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_3 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_3 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
pdf("example_l2_3.pdf",width=9, height=7.5)
grid.arrange(p_50_2a_l2_3, p_500_2a_l2_3, p_infty_2a_l2_3, ncol=1)
dev.off()
comparison_l2_4 <- comparison_l2[,c(25:32,34)]
names_comparisons_l2_4 <- names_comparisons_l2[c(25:32,34)]
p_50_2a_l2_4 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_4 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_4 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
pdf("example_l2_4.pdf",width=9, height=7.5)
grid.arrange(p_50_2a_l2_4, p_500_2a_l2_4, p_infty_2a_l2_4, ncol=1)
dev.off()
# comparison_l2_5 <- as.matrix(comparison_l2[,33])
# names_comparisons_l2_5 <- names_comparisons_l2[33]
# p_50_2a_l2_5 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_5,names_comparisons_l2_5,title=TeX("$G_{2a}, n=20$"))
# p_500_2a_l2_5 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_5,names_comparisons_l2_5,title=TeX("$G_{2a}, n=500$"))
# p_infty_2a_l2_5 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_5,names_comparisons_l2_5,title=TeX("$G_{2a}$"),ytitle="Asy. SD ratio")
#
# pdf("example_l2_5.pdf",width=9, height=7.5)
# grid.arrange(p_50_2a_l2_5, p_500_2a_l2_5, p_infty_2a_l2_5, ncol=1)
# dev.off()
pdf("example_l2_a.pdf",width=9, height=15)
grid.arrange(p_50_2a_l2_1, p_500_2a_l2_1, p_infty_2a_l2_1,
p_50_2a_l2_2, p_500_2a_l2_2, p_infty_2a_l2_2, ncol=1)
dev.off()
pdf("example_l2_b.pdf",width=9, height=15)
grid.arrange(p_50_2a_l2_3, p_500_2a_l2_3, p_infty_2a_l2_3,
p_50_2a_l2_4, p_500_2a_l2_4, p_infty_2a_l2_4, ncol=1)
dev.off()
grid.arrange(p_50_2a_l2_2, p_500_2a_l2_2, p_infty_2a_l2_2, ncol=1)
grid.arrange(p_50_2a_l2_1, p_500_2a_l2_1, p_infty_2a_l2_1,
p_50_2a_l2_2, p_500_2a_l2_2, p_infty_2a_l2_2, ncol=1)
comparison_l2 <- rbind(c(rep(31,34)),c(1:30,32:35))
names_comparisons_l2 <- c("(A,\u2205)",
"(A,B)",
"(A,C)",
"(A,{B,C})",
"(B,\u2205)",
"(B,A)",
"(B,C)",
"(B,D)",
"(B,{A,C})",
"(B,{A,D})",
"(B,{C,D})",
"(B,{A,B,D})",
"(D,\u2205)",
"(D,A)",
"(D,B)",
"(D,C)",
"(D,{A,B})",
"(D,{A,C})",
"(D,{B,C})",
"(D,{A,B,C})",
"({A,B},\u2205)",
"({A,B},C)",
"({A,B},D)",
"({A,B},{C,D})",
"({A,D},\u2205)",
"({A,D},B)",
"({A,D},C)",
"({A,D},{B,C})",
"({B,D},\u2205)",
"({B,D},A)",
"({B,D},{A,C})",
"({A,B,D},\u2205)",
"({A,B,D},C)",
"OLS"
)
comparison_l2_1 <- comparison_l2[,1:8]
names_comparisons_l2_1 <- names_comparisons_l2[1:8]
p_50_2a_l2_1 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_1 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_1 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
comparison_l2_2 <- comparison_l2[,9:16]
names_comparisons_l2_2 <- names_comparisons_l2[9:16]
p_50_2a_l2_2 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_2 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_2 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
comparison_l2_3 <- comparison_l2[,17:25]
names_comparisons_l2_3 <- names_comparisons_l2[17:25]
p_50_2a_l2_3 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_3 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_3 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
comparison_l2_4 <- comparison_l2[,c(25:33)]
names_comparisons_l2_4 <- names_comparisons_l2[c(25:32,34)]
p_50_2a_l2_4 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}, n=50$"))
p_500_2a_l2_4 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}, n=500$"))
p_infty_2a_l2_4 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio")
grid.arrange(p_50_2a_l2_4, p_500_2a_l2_4, p_infty_2a_l2_4, ncol=1)
p_50_2a_l2_1 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}, n=50$"),bw=0.1)
p_500_2a_l2_1 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}, n=500$"),bw=0.1)
p_infty_2a_l2_1 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_1,names_comparisons_l2_1,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio",bw=0.1)
comparison_l2_2 <- comparison_l2[,9:16]
names_comparisons_l2_2 <- names_comparisons_l2[9:16]
p_50_2a_l2_2 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}, n=50$"),bw=0.1)
p_500_2a_l2_2 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}, n=500$"),bw=0.1)
p_infty_2a_l2_2 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_2,names_comparisons_l2_2,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio",bw=0.1)
comparison_l2_3 <- comparison_l2[,17:25]
names_comparisons_l2_3 <- names_comparisons_l2[17:25]
p_50_2a_l2_3 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}, n=50$"),bw=0.1)
p_500_2a_l2_3 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}, n=500$"),bw=0.1)
p_infty_2a_l2_3 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_3,names_comparisons_l2_3,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio",bw=0.1)
comparison_l2_4 <- comparison_l2[,c(25:33)]
names_comparisons_l2_4 <- names_comparisons_l2[c(25:33)]
p_50_2a_l2_4 <- plot_MSE_comparison(RMSE_2[n==50,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}, n=50$"),bw=0.1)
p_500_2a_l2_4 <- plot_MSE_comparison(RMSE_2[n==500,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}, n=500$"),bw=0.1)
p_infty_2a_l2_4 <- plot_MSE_comparison(aSE_2[n==50,],comparison_l2_4,names_comparisons_l2_4,title=TeX("$G_{2}$"),ytitle="Asy. SD ratio",bw=0.1)
grid.arrange(p_50_2a_l2_1, p_500_2a_l2_1, p_infty_2a_l2_1,
p_50_2a_l2_2, p_500_2a_l2_2, p_infty_2a_l2_2, ncol=1)
pdf("example_l2_a.pdf",width=9, height=15)
grid.arrange(p_50_2a_l2_1, p_500_2a_l2_1, p_infty_2a_l2_1,
p_50_2a_l2_2, p_500_2a_l2_2, p_infty_2a_l2_2, ncol=1)
dev.off()
grid.arrange(p_50_2a_l2_3, p_500_2a_l2_3, p_infty_2a_l2_3,
p_50_2a_l2_4, p_500_2a_l2_4, p_infty_2a_l2_4, ncol=1)
pdf("example_l2_b.pdf",width=9, height=15)
grid.arrange(p_50_2a_l2_3, p_500_2a_l2_3, p_infty_2a_l2_3,
p_50_2a_l2_4, p_500_2a_l2_4, p_infty_2a_l2_4, ncol=1)
dev.off()
RMSE_jive_1 <- RMSE_joint_1[,41:60]
RMSE_liml_1 <- RMSE_joint_1[,61:80]
plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_1,names_comparisons_1,title=TeX("$G_{1}, n=50$"),bw=0.1)
comparison_alt <- matrix(c(
18,1,
# 18,2,
# 18,3,
# 18,4,
18,5,
18,6,
18,7,
18,10,
18,11
# 15,14,
),nrow=2)
names_alt <- c(
"(B,C)",
# "(B,{A,C})",
# "(B,{C,D})",
# "(B,{A,C,D})",
"(D,B)",
"(D,C)",
"(D,{B,C})",
"(D,{A,B,C})",
"({B,D},C)"
# "{{B,C},{A}}",
)
plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_comparisons_alt,title=TeX("$G_{1}, n=50$"),bw=0.1)
plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50$"),bw=0.1)
comparison_alt <- matrix(c(
18,1,
18,2,
18,3,
18,4,
18,5,
18,6,
18,7,
18,10,
18,11
# 15,14,
),nrow=2)
names_alt <- c(
"(B,C)",
"(B,{A,C})",
"(B,{C,D})",
"(B,{A,C,D})",
"(D,B)",
"(D,C)",
"(D,{B,C})",
"(D,{A,B,C})",
"({B,D},C)"
# "{{B,C},{A}}",
)
plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50$"),bw=0.1)
p_50_1a_alt <- plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50$"),bw=0.1)
p_500_1a_alt <- plot_MSE_comparison(RMSE_jive_1[n==500,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50$"),bw=0.1)
grid.arrange(p_50_1a_alt, p_500_1a_alt, nrow=2)
p_50_1a_alt <- plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50$"),bw=0.1)
p_500_1a_alt <- plot_MSE_comparison(RMSE_jive_1[n==500,],comparison_alt,names_alt,title=TeX("$G_{1}, n=500$"),bw=0.1)
grid.arrange(p_50_1a_alt, p_500_1a_alt, nrow=2)
p_50_1a_alt <- plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50, JIVE$"),bw=0.1)
p_500_1a_alt <- plot_MSE_comparison(RMSE_jive_1[n==500,],comparison_alt,names_alt,title=TeX("$G_{1}, n=500, LIML$"),bw=0.1)
grid.arrange(p_50_1a_alt, p_500_1a_alt, nrow=2)
grid.arrange(p_50_1a_jive, p_500_1a_jive, p_500_1a_liml, p_500_1a_liml, nrow=4)
p_50_1a_jive <- plot_MSE_comparison(RMSE_jive_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50, JIVE$"),bw=0.1)
p_500_1a_jive <- plot_MSE_comparison(RMSE_jive_1[n==500,],comparison_alt,names_alt,title=TeX("$G_{1}, n=500, JIVE$"),bw=0.1)
p_50_1a_liml <- plot_MSE_comparison(RMSE_liml_1[n==50,],comparison_alt,names_alt,title=TeX("$G_{1}, n=50, LIML$"),bw=0.1)
p_500_1a_liml <- plot_MSE_comparison(RMSE_liml_1[n==500,],comparison_alt,names_alt,title=TeX("$G_{1}, n=500, LIML$"),bw=0.1)
grid.arrange(p_50_1a_jive, p_500_1a_jive, p_500_1a_liml, p_500_1a_liml, nrow=4)
grid.arrange(p_50_1a_liml, p_500_1a_liml,p_50_1a_jive, p_500_1a_jive, nrow=4)
comparison_alt <- matrix(c(31,13,
31,14,
31,15,
31,16,
31,18,
31,20,
31,21,
31,25,
31,29
# 31,33,
),nrow=2)
names_alt <- c("(D,\u2205)",
"(D,A)",
"(D,B)",
"(D,C)",
"(D,{A,C})",
"(D,{A,B,C})",
"({A,B},\u2205)",
"({A,D},\u2205)",
"({B,D},\u2205)"
# "{{A,B,D},em}",
)
RMSE_jive_2 <- RMSE_joint_2[,73:108]
RMSE_liml_2 <- RMSE_joint_2[,109:144]
comparison_alt_2 <- matrix(c(31,13,
31,14,
31,15,
31,16,
31,18,
31,20,
31,21,
31,25,
31,29
# 31,33,
),nrow=2)
names_alt_2 <- c("(D,\u2205)",
"(D,A)",
"(D,B)",
"(D,C)",
"(D,{A,C})",
"(D,{A,B,C})",
"({A,B},\u2205)",
"({A,D},\u2205)",
"({B,D},\u2205)"
# "{{A,B,D},em}",
)
p_50_2a_jive <- plot_MSE_comparison(RMSE_jive_2[n==50,],comparison_alt_2,names_alt_2,title=TeX("$G_{2}, n=50, JIVE$"),bw=0.1)
p_500_2a_jive <- plot_MSE_comparison(RMSE_jive_2[n==500,],comparison_alt_2,names_alt_2,title=TeX("$G_{2}, n=500, JIVE$"),bw=0.1)
p_50_2a_liml <- plot_MSE_comparison(RMSE_liml_2[n==50,],comparison_alt_2,names_alt_2,title=TeX("$G_{2}, n=50, LIML$"),bw=0.1)
p_500_2a_liml <- plot_MSE_comparison(RMSE_liml_2[n==500,],comparison_alt_2,names_alt_2,title=TeX("$G_{2}, n=500, LIML$"),bw=0.1)
grid.arrange(p_50_2a_liml, p_500_2a_liml,p_50_2a_jive, p_500_2a_jive, nrow=4)
pdf("limljive_2.pdf",width=9, height=3.75)
grid.arrange(p_50_2a_liml, p_500_2a_liml,p_50_2a_jive, p_500_2a_jive, nrow=4)
dev.off()
pdf("limljive_1.pdf",width=9, height=3.75)
grid.arrange(p_50_1a_liml, p_500_1a_liml,p_50_1a_jive, p_500_1a_jive, nrow=4)
dev.off()
grid.arrange(p_50_1a_liml, p_500_1a_liml,p_50_1a_jive, p_500_1a_jive,p_50_2a_liml, p_500_2a_liml,p_50_2a_jive, p_500_2a_jive, nrow=8)
pdf("limljive.pdf",width=9, height=3.75)
grid.arrange(p_50_1a_liml, p_500_1a_liml,p_50_1a_jive, p_500_1a_jive,p_50_2a_liml, p_500_2a_liml,p_50_2a_jive, p_500_2a_jive, nrow=8)
dev.off()
pdf("limljive.pdf",width=9, height=18)
grid.arrange(p_50_1a_liml, p_500_1a_liml,p_50_1a_jive, p_500_1a_jive,p_50_2a_liml, p_500_2a_liml,p_50_2a_jive, p_500_2a_jive, nrow=8)
dev.off()
